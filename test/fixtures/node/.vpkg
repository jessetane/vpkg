#!/usr/bin/env bash
#
# vpkgfile for node
#

default_version="0.8.20"

install() {
  
  # vars
  os=$(uname | awk '{ print(tolower($1)) }')
  arch=$(uname -p) && arch="${arch: -2}"
  fname="node-v$source_version-$os-x$arch"
  url="http://nodejs.org/dist/v$source_version/$fname.tar.gz"
  
  # we have source code?
  if [ ! -e "$src"/build/"$source_version" ]
  then
    mkdir -p "$src"/build && cd $_
    echo "downloading $url..."
    ! curl -fLO# "$url" && echo "version $source_version could not be downloaded" >&2 && exit 1
    tar -xvzf "$fname".tar.gz > /dev/null 2>&1
    rm -rf "$fname".tar.gz
    mv node* "$source_version"
  fi
  
  # install
  cp -R "$src"/build/"$source_version" "$lib"/"$version"
}
